<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/ApiService.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/ApiService.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
import { Debug } from '../helpers/Debug.js';

/**
 * ApiService - Singleton para gerenciar a comunicação com a fonte de dados (arquivos JSON).
 *
 * Este serviço é responsável APENAS por buscar (fetch) os dados brutos.
 * A transformação e a lógica de negócios são tratadas pelo CourseRepository.
 */
class ApiService {
    constructor() {
        if (ApiService.instance) {
            return ApiService.instance;
        }
        ApiService.instance = this;
        this.baseUrl = './data';
    }

    /**
     * Busca o índice de cursos do arquivo courses.json.
     * @returns {Promise&lt;object[]>} Uma promessa que resolve para o array de metadados de cursos.
     */
    async fetchCourseIndex() {
        Debug.log('ApiService', 'Buscando índice de cursos (raw)...');
        try {
            const courseIndexData = await this._fetchJson(`${this.baseUrl}/courses.json`);
            Debug.table('ApiService', 'Índice de Cursos Recebido (raw)', courseIndexData);
            return courseIndexData;
        } catch (error) {
            Debug.error('ApiService', 'Falha ao buscar o índice de cursos:', error);
            throw error; // Lança o erro para ser tratado pelo chamador (CourseRepository)
        }
    }

    /**
     * Busca os dados brutos de um curso específico (metadados e aulas).
     * @param {string} courseId O ID do curso a ser buscado.
     * @returns {Promise&lt;{courseMeta: object, lessonsData: object[]}>}
     */
    async fetchCourseData(courseId) {
        Debug.log('ApiService', `Buscando dados brutos para o curso com ID: ${courseId}`);
        Debug.updateView('Curso', courseId);

        try {
            const courseIndexData = await this._fetchJson(`${this.baseUrl}/courses.json`);
            const courseMeta = courseIndexData.find(c => c.id === courseId);

            if (!courseMeta) {
                throw new Error(`Curso com id '${courseId}' não encontrado no índice.`);
            }

            const lessonsData = await this._fetchJson(`${this.baseUrl}/${courseId}/aulas.json`);
            Debug.log('ApiService', `Dados das aulas para o curso '${courseId}' recebidos (raw).`, lessonsData);

            return { courseMeta, lessonsData };

        } catch (error) {
            Debug.error('ApiService', `Falha ao buscar os dados brutos do curso '${courseId}':`, error);
            throw error; // Lança o erro para ser tratado pelo chamador (CourseRepository)
        }
    }

    /**
     * Função auxiliar para buscar e parsear JSON com tratamento de erro.
     * @param {string} url A URL do JSON a ser buscado.
     * @returns {Promise&lt;any>}
     * @private
     */
    async _fetchJson(url) {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(`Falha na requisição para ${url} - Status: ${response.status}`);
        }
        return response.json();
    }
}

// Exporta a instância única do serviço para ser usada em toda a aplicação.
export const apiService = new ApiService();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ApiService.html">ApiService</a></li><li><a href="Course.html">Course</a></li><li><a href="CourseRepository.html">CourseRepository</a></li><li><a href="DebugView.html">DebugView</a></li><li><a href="EventBus.html">EventBus</a></li><li><a href="Lesson.html">Lesson</a></li><li><a href="PlaygroundComponent.html">PlaygroundComponent</a></li></ul><h3>Global</h3><ul><li><a href="global.html#bannerConfig">bannerConfig</a></li><li><a href="global.html#capitalizeFirstLetter">capitalizeFirstLetter</a></li><li><a href="global.html#managePlaygroundButton">managePlaygroundButton</a></li><li><a href="global.html#renderHomeView">renderHomeView</a></li><li><a href="global.html#renderLessonCreatorView">renderLessonCreatorView</a></li><li><a href="global.html#renderPlaygroundView">renderPlaygroundView</a></li><li><a href="global.html#reverseString">reverseString</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
